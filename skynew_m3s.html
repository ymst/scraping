<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <!--- basic page needs    ================================================== -->
    <meta charset="utf-8">
    <title>Mok Space</title>
    <meta content="puppeteer,chrome,javascript,browser,node.js,ブラウザ,scraping,scrape,スクレイピング,mac,windows,linux,ios,android,csv,excel,spreadsheet,エクセル,スプレッドシート,eBay,amazon,キーワード,keyword,automation,auto,automated,macro,script,bot,自動,マクロ,スクリプト,ボット", name="keyword">
    <meta content="puppeteerを使ってECサイトから商品情報をスクレイピングすることが目的です" name="description">
    <meta name="author" content="">
    <!-- mobile specific metas    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Kosugi+Maru&amp;subset=cyrillic,japanese" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Kanit" rel="stylesheet">
    <!-- CSS    ================================================== -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/main.css">
    <!-- script    ================================================== -->
    <script src="js/modernizr.js"></script>
    <script src="js/pace.min.js"></script>
    <!-- favicons    ================================================== -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-133844353-4"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-133844353-4');
    </script>

</head>
<style>
  /* CSS for LQIP blur added by Yama190220
   use calss "lazyload blur" instead of "lazyload" */
.blur {
    -webkit-filter: blur(3px);
    filter: blur(3px);
    transition: filter 600ms, -webkit-filter 600ms;
}
.blur.lazyloaded {
    -webkit-filter: blur(0);
    filter: blur(0);
}
.yy_title {
    padding: 0.4em 0.5em; /* 文字の上下 左右の余白 */
    color: #494949; /* 文字色 */
    /* background: #f4f4f4; */ /* 背景色 */
    border-left: solid 5px #7db4e6; /* 左線 */
    border-bottom: solid 3px #d7d7d7; /* 下線 */
}
.yy_marker {
    background:rgba(0, 0, 0, 0) linear-gradient(transparent 60%, #FFDFEF 0%) repeat scroll 0 0;
}
.yy_marker2 {
    background:rgba(0, 0, 0, 0) linear-gradient(transparent 60%, #cce5ff 0%) repeat scroll 0 0;
}
.yy_marker3 {
    background:rgba(0, 0, 0, 0) linear-gradient(transparent 60%, #ffffbc 0%) repeat scroll 0 0;
}
.yy_date {
    text-align: left;
    color: #ff6347;
}
.yy_author {
    text-align: right;
    color: #5f9ea0;
}
.yy_pubdate {
    text-align: right;
    color: #006400;
}
</style>
<body id="top">
    <!-- pageheader    ================================================== -->
    <section class="s-pageheader s-pageheader--home">
        <header class="header">
            <div class="header__content row">
	      <h1 style="color: white;">Mok Space</h1>
                <a class="header__toggle-menu" href="#0" title="Menu"><span>メニュー</span></a>
                <nav class="header__nav-wrap">
                    <h2 class="header__nav-heading h6">ナビゲーション</h2>
                    <ul class="header__nav">
                        <li><a href="top.html" title="">トップページ</a></li>
                        <li><a href="skynew_m3s.html" title="">skynew m3sの設定</a></li>
                        <li><a href="centos_env.html" title="">centosの環境の構築</a></li>
                        <li><a href="puppeteer_tips.html" title="">puppeteer TIPs</a></li>
			<li class="has-children">
                            <a href="#0" title="">スクリプト例</a>
                            <ul class="sub-menu">
                              <li><a href="prepare.html" title="">環境の準備</a></li>
                              <li><a href="search_ebay.html" title="">eBay検索スクリプト</a></li>
                              <li><a href="search_amzn.html" title="">amazon画像検索スクリプト</a></li>
                              <li><a href="create_html.html" title="">HTML作成スクリプト</a></li>
                              <li><a href="proxy.html" title="">プロキシの準備</a></li>
                              <li><a href="order_script.html" title="">販売について</a></li>
                            </ul>
                        </li>
			<li class="has-children">
                            <a href="#0" title="">PDF版 官報収集</a>
                            <ul class="sub-menu">
                              <li><a href="prepare2.html" title="">環境の準備</a></li>
                              <li><a href="get_kanpou2.html" title="">スクリプト説明</a></li>
                              <li><a href="example2.html" title="">運用例</a></li>
                              <li><a href="order_script2.html" title="">販売について</a></li>
                            </ul>
                        </li>
			<li class="has-children">
                            <a href="#0" title="">BIT競売物件収集</a>
                            <ul class="sub-menu">
                              <li><a href="prepare3.html" title="">環境の準備</a></li>
                              <li><a href="collect_bit3.html" title="">スクリプト説明</a></li>
                              <li><a href="order_script3.html" title="">販売について</a></li>
                            </ul>
                        </li>
                        <!-- li><a href="top.html" title="">トップページ</a></li>
                        <li class="current"><a href="skynew_m3s.html" title="">skynew m3sの設定</a></li>
                        <li><a href="centos_env.html" title="">centosの環境の構築</a></li>
                        <li><a href="puppeteer_tips.html" title="">puppeteer TIPs</a></li -->
                    </ul> <!-- end header__nav -->
                    <a href="#0" title="Close Menu" class="header__overlay-close close-mobile-menu">Close</a>
                </nav> <!-- end header__nav-wrap -->
            </div> <!-- header-content -->
        </header> <!-- header -->
    </section> <!-- end s-pageheader -->
    <!-- s-content    ================================================== -->
    <section class="s-content">

        <div class="row narrow section-intro add-bottom text-center">
            <div class="col-twelve tab-full">
                <h1>Skynew m3sの設定</h1>
            </div>
        </div>

        <div class="row">
            <div class="col-six tab-full">
                <h3 class="yy_title">centosインストール</h3>
		<p>まずは、bootable USBを作る。CentOSのDVDイメージをダウンロードし、手持ちのUSBメモリスティックをFAT32でフォーマット、最後にunetbootinでbootable USBが完成。</p>
		<p>この作業は6年前に購入したVAIOノートで稼働しているpuppy linux上で行った。</p>
		<p>そしてm3sを起動して、まずはWindowsが立ち上がることを確認。</p>
		<p>上で作成したUSBスティックを差し、F12を押しながら電源オンにてCentOSのインストーラを起動、Windowsの入っていた領域を消去してインストール。</p>
		<p>ないと困ると思ったのは、USB有線キーボードとマウス。押し入れに潜り込んでようやく見つけた。</p>
            </div>
        </div>

        <div class="row">
            <div class="col-six tab-full">
                <h3 class="yy_title">HFS+から抜け出した話</h3>
		<p>これまでiMacで使っていたデータが詰まったHFS+のHDD達①をごっそり移し替える。iMacでは作業したくなかったので、m3sにUSBで接続してHFS+を読み込めるようにkmod-hfsplusを入れた。そしてHFS+のHDDを接続、マウント後、読み書きできるかを確認。</p>
		<p>そしてiMacで使っていたRAID1用HDD②を1つ切り離し、m3sに接続。このHDDに①をごっそりコピーすることにする。</p>
<pre><code>parted -l</code></pre>
		<p>でデバイス名と容量を確認した後</p>
<pre><code>// sd[a-z]はデバイス名
parted /dev/sd[a-z]</code></pre>
		<p>でパーティションを作成、ext4でフォーマット。そして②をm3sでマウントし、①のデータを</p>
<pre><code>tar cf - ./* |
  (cd dist ; tar xf -)</code></pre>
		<p>でせこせことコピーする。コピーした後①のHDDはすべてext4でフォーマット、バックアップ用とすることにした。RAID組むのも良かったけども、面倒なのでcronでrsyncを動かすことにする。1日に2度バックアップするようにした。</p>
<pre><code>setenv EDITOR /usr/bin/emacs
crontab -e
</code></pre>
		<p>でcrontabの編集もemacsを使えます。viは苦手。</p>
            </div>
        </div>

        <div class="row">
            <div class="col-six tab-full">
                <h3 class="yy_title">Sambaのマウント</h3>
		<p>次はルータ兼sambaサーバにぶら下がっているHDDをマウントする。</p>
		<p>うちのルータはAterm WG600HPで、こいつのSambaサーバ機能でUSB接続したHDDをあちこちからアクセスしている。</p>
		<p>そのためm3sのfstabでこれをマウントしなくてはならないが、なかなか上手くいかなかった。</p>
		<p>『ルータのsambaサーバが古くてSMB1しか使えないので、fstabにvers=1.0と書かなければならない』ことに辿り着くまで随分時間がかかった。</p>
		<p>ついでに、fstabでマウントポイントを固定したかったので調べてみたら、blkidコマンドで調べたデバイスのUUIDを使って指定できると見つけたので、早速fstabも修正した。</p>
            </div>
        </div>
            
        <div class="row">
            <div class="col-six tab-full">
                <h3 class="yy_title">Wifi接続でトラブった</h3>
		<p>これまで有線LANで作業してきたが、ようやく切り離してwifiルータとの接続。</p>
		<p>ん？wifiが全然繋がらない、ルータが同じ部屋にあると平気なのだが壁をはさむと途端にダメ。</p>
		<p>そんなバカな！？</p>
		<p>iMacもiPhoneもAndroidも壁越しでもwifi掴むのになぜ？と調べたところ、iwlwifiの設定でpower_level=0と最小になっていることを発見。</p>
<pre><code>$echo "options iwlwifi 11n_disable=8 power_level=5"
    >  /etc/modprobe.d/iwlwifi.conf</code></pre>
                <p>としてリブートするとサックリ繋がった。</p>
                <p>11nはアグリゲーションらしいけどうちのルータは古いので対応していない。</p>
            </div>
        </div>

        <div class="row">
            <div class="col-six tab-full">
                <h3 class="yy_title">Node.jsとpuppeteer</h3>
		<p>headless chrome用にpuppeteerもインストール。</p>
<pre><code>$yum install nodejs
$npm install puppeteer</code></pre>
		<p>両方ともrootでやると良い、のかな？</p>
		<p>そうしないと、自由にディレクトリ作ってpuppeteerが動かなかった気が…忘れた。</p>
            </div>
        </div>

        <div class="row">
            <div class="col-six tab-full">
                <h3 class="yy_title">キーボードの設定</h3>
		<p>iMacもAndroidもBluetooth K760キーボードで済ませている。m3sもこのキーボードを使いまわしたい。</p>
		<p>こいつはus Macキーボード配列。</p>
		<p>それをm3sで使うべく以下のコマンド実行。</p>
<pre><code>$localectl set-X11-keymap us-mac
$localectl set-keymap jp
$localectl status</code></pre>
            </div>
        </div>

        <div class="row">
            <div class="col-six tab-full">
                <h3 class="yy_title">マウスの動きが悪かった</h3>
		<p>マウスの加速が気持ち悪い。少し遅れてズズズッと追いかけてくる感じ。ストレス半端ない。</p>
		<p>non rootでgnome-teaksを実行すると設定ウインドウが開くので、<br><u>マウスアクセラレーション→flat</u><br>に変更。</p>
		<p>安物Bluetoothマウスとの相性が悪いのか、思ったよりキビキビ動作しない…どうせGUIで使うのがメインじゃないのでこれで妥協した。</p>
            </div>
        </div>

    </section>
    <footer class="s-footer">
        <div class="s-footer__main">
            <div class="row">
	        <!-- ul>
		    <span><u>その他のスクリプト</u></span>
		    <li>ECサイトから商品情報を取得する<a href="index.html">スクリプト</a></li>
		    <li>官報をダウンロードする<a href="index2.html">スクリプト</a></li>
		    <li>競売情報をダウンロードする<a href="index3.html">スクリプト</a></li>
		</ul -->
            </div>
        </div> <!-- end s-footer__main -->
        <div class="s-footer__bottom">
            <div class="row">
                <div class="col-full">
                    <div class="s-footer__copyright">
                        <span>© Copyright Philosophy 2018</span>
                        <span>Site Template by <a href="https://colorlib.com/">Colorlib</a></span>
                    </div>
                    <div class="go-top">
                        <a class="smoothscroll" title="Back to Top" href="#top"></a>
                    </div>
                </div>
            </div>
        </div> <!-- end s-footer__bottom -->
    </footer> <!-- end s-footer -->
    <!-- preloader    ================================================== -->
    <div id="preloader">
        <div id="loader">
            <div class="line-scale">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </div>
    </div>
    <!-- Java Script    ================================================== -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
